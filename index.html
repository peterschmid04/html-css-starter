<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" media="all" href="style.css">
    <title>Tripsi</title>
</head>
<body>
    <div class="gallery">
      <div class="header">
        <button data-category="all" class="category active">Show all</button>
        <button data-category="nature" class="category">Nature</button>
        <button data-category="hiking" class="category">Hiking</button>
        <button data-category="traveling" class="category">Traveling</button>

        <button class="addCardButton" id="addCardButton">+</button>

      </div>
      <section class="gallery-grid" id="gallery">

    </div>
  
    <dialog id="imageDialog">
      <div class="dialog-content">
          <img id="dialogImage" src="" alt="">
          <input id="dialogTitle" type="text" placeholder="title">
          <input id="dialogDescription" type="text" placeholder="description ">
          <button id="closeDialog">Close</button>
          <button id="safeDialog">Safe</button>
      </div>
    </dialog>

  <script>
    const images = [
        { title: "tent", category: "hiking nature", imageUrl: "images/tent.jpg" },
        { title: "landscape", category: "nature", imageUrl: "images/ landscape.jpg" },
        { title: "camper", category: "traveling", imageUrl: "images/camper.jpg" },
        { title: "hiking", category: "hisking", imageUrl: "images/hiking.jpg" },
        { title: "house", category: "hiking", imageUrl: "images/house.jpg" },
        { title: "mountains", category: "hiking mountains", imageUrl: "images/mountains.jpg" },
        { title: "lake", category: "nature", imageUrl: "images/lake.jpg" },
        { title: "traveling", category: "traveling", imageUrl: "images/traveling.jpg" }
    ];  

    const gallery = document.getElementById("gallery");

    images.forEach(image => {
        const card = document.createElement("div");
        card.className = "card";
        card.dataset.category = image.category;

        card.innerHTML = `
            <div class="image-bg" style="background-image: url('${image.imageUrl}');"></div>
            <input class="title" type="text" value="${image.title}" placeholder="title">
            <input class="description" type="text" placeholder="description">
        `;

        gallery.appendChild(card);
    });

    const buttons = document.querySelectorAll(".category"); // Filter-Buttons
    const galleryContainer = document.querySelectorAll(".gallery-grid .card"); // Galeriekarten
    const dialog = document.getElementById("imageDialog");
    const dialogImage = document.getElementById("dialogImage");
    const dialogTitle = document.getElementById("dialogTitle");
    const dialogDescription = document.getElementById("dialogDescription");
    const closeDialog = document.getElementById("closeDialog");
    const saveDialog = document.getElementById("safeDialog");
    const addCardButton = document.getElementById("addCardButton");

    let currentImageDiv = null; // Aktuelles Bild-Container-Element speichern


    // Filterfunktion für die Buttons
    buttons.forEach(button => {
    button.addEventListener("click", () => {
        buttons.forEach(btn => btn.classList.remove("active"));
        button.classList.add("active");

        const category = button.dataset.category;
        document.querySelectorAll(".gallery-grid .card").forEach(imageDiv => { 
            const categories = imageDiv.dataset.category.split(" ");
            imageDiv.style.display = (category === "all" || categories.includes(category)) ? "grid" : "none";
        });
    });
});

addCardButton.addEventListener("click", () => {
    // Leeren Dialog öffnen, um eine neue Karte zu erstellen
    currentImageDiv = null; // Setzt das aktuelle Bild auf null für neuen Eintrag
    dialogImage.src = "";
    dialogImage.alt = "";
    dialogTitle.value = "";
    dialogDescription.value = "";
    dialog.showModal();
});

// Safe-Button: Neue Karte hinzufügen oder bestehende Karte aktualisieren
safeDialog.addEventListener("click", () => {
    if (currentImageDiv) {
        // Bestehende Karte aktualisieren
        const titleInput = currentImageDiv.querySelector(".title");
        const descriptionInput = currentImageDiv.querySelectorAll("input[type='text']")[1];

        titleInput.value = dialogTitle.value;
        descriptionInput.value = dialogDescription.value;

    } else {
        // Neue Karte erstellen
        const newCard = document.createElement("div");
        newCard.className = "card";
        newCard.dataset.category = "new"; // Standardkategorie oder anpassbar

        newCard.innerHTML = `
            <div class="image-bg" style="background-image: url('images/placeholder.jpg');"></div>
            <input class="title" type="text" value="${dialogTitle.value}" placeholder="title">
            <input class="description" type="text" placeholder="description" value="${dialogDescription.value}">
        `;

        // Neue Karte in die Galerie einfügen
        gallery.appendChild(newCard);
        
        // Klick-Event für neue Karte hinzufügen
        newCard.querySelector(".image-bg").addEventListener("click", () => {
            currentImageDiv = newCard;
            const title = newCard.querySelector(".title").value;
            const description = newCard.querySelector(".description").value;

            const imageUrl = newCard.querySelector(".image-bg").style.backgroundImage.replace('url("', '').replace('")', '');

            dialogImage.src = imageUrl;
            dialogImage.alt = title;
            dialogTitle.value = title;
            dialogDescription.value = description;

            dialog.showModal();
        });
    }

    dialog.close();
});

    // Bild anklicken -> Dialog öffnen
    galleryContainer.forEach(card  => {
        const imageBg = card.querySelector(".image-bg");

        imageBg.addEventListener("click", () => {
            currentImageDiv = card; // Speichert das aktuell angeklickte Card-Element
            const title = currentImageDiv.querySelector(".title").value;
            const description = currentImageDiv.querySelector(".description").value;

            const imageUrl = imageBg.style.backgroundImage.replace('url("', '').replace('")', '');

            // Hintergrundbild und Daten in den Dialog setzen
                   // Setze das Bild im Dialog
        dialogImage.src = imageUrl;
        dialogImage.alt = title;
        dialogTitle.value = title;
        dialogDescription.value = description;

            dialog.showModal();
        });
    });

    // Dialog schließen
    closeDialog.addEventListener("click", () => {
        dialog.close();
    });

    // Safe-Button: Werte speichern
    safeDialog.addEventListener("click", () => {
        if (currentImageDiv) {
            const titleInput = currentImageDiv.querySelector(".title");
            const descriptionInput = currentImageDiv.querySelectorAll("input[type='text']")[1];

            titleInput.value = dialogTitle.value;
            descriptionInput.value = dialogDescription.value;

            dialog.close();
        }
    });
  </script>
</body>
</html>